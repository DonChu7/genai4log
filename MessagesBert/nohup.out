device cpu
features logkey:True time: False

mask ratio 0.65
arguments Namespace(mode='train')
Save options parameters
Loading vocab ../output/linux/vocab.pkl
vocab Size:  179

Loading Train Dataset
before filtering short session
train size  74
valid size  3
========================================
  0%|          | 0/77 [00:00<?, ?it/s]100%|██████████| 77/77 [00:00<00:00, 78560.30it/s]
========================================
Num of train seqs 74
Num of valid seqs 3
========================================

Loading valid Dataset
Creating Dataloader
Building BERT model
Creating BERT Trainer
Total Parameters: 2201780
Training Start


start calculate center
  0%|          | 0/2 [00:00<?, ?it/s]/Users/dongyzhu/Desktop/Oracle/genAIforlog/logbert/MessagesBert/../bert_pytorch/dataset/log_dataset.py:130: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:257.)
  output["time_input"] = torch.tensor(output["time_input"], dtype=torch.float)
/Users/dongyzhu/Desktop/Oracle/genAIforlog/logbert/MessagesBert/../bert_pytorch/dataset/log_dataset.py:130: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:257.)
  output["time_input"] = torch.tensor(output["time_input"], dtype=torch.float)
 50%|█████     | 1/2 [00:04<00:04,  4.45s/it]device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
100%|██████████| 2/2 [00:14<00:00,  7.26s/it]
0it [00:00, ?it/s]device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
0it [00:03, ?it/s]
/Users/dongyzhu/Desktop/Oracle/genAIforlog/logbert/MessagesBert/../bert_pytorch/dataset/log_dataset.py:130: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:257.)
  output["time_input"] = torch.tensor(output["time_input"], dtype=torch.float)
/Users/dongyzhu/Desktop/Oracle/genAIforlog/logbert/MessagesBert/../bert_pytorch/dataset/log_dataset.py:130: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /Users/runner/work/pytorch/pytorch/pytorch/torch/csrc/utils/tensor_new.cpp:257.)
  output["time_input"] = torch.tensor(output["time_input"], dtype=torch.float)
device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
Epoch: 0 | phase: train, loss=5.644238710403442
logkey loss: 5.51784873008728, hyper loss: 1.263899326324463

device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
device cpu
features logkey:True time: False

mask ratio 0.65
Traceback (most recent call last):
  File "/Users/dongyzhu/Desktop/Oracle/genAIforlog/logbert/MessagesBert/logbert.py", line 102, in <module>
    Trainer(options).train()
  File "/Users/dongyzhu/Desktop/Oracle/genAIforlog/logbert/MessagesBert/../bert_pytorch/train_log.py", line 106, in train
    self.start_iteration(surfix_log="log2")
  File "/Users/dongyzhu/Desktop/Oracle/genAIforlog/logbert/MessagesBert/../bert_pytorch/train_log.py", line 125, in start_iteration
    avg_loss, valid_dist = self.trainer.valid(epoch)
  File "/Users/dongyzhu/Desktop/Oracle/genAIforlog/logbert/MessagesBert/../bert_pytorch/trainer/pretrain.py", line 104, in valid
    return self.iteration(epoch, self.valid_data, start_train=False)
  File "/Users/dongyzhu/Desktop/Oracle/genAIforlog/logbert/MessagesBert/../bert_pytorch/trainer/pretrain.py", line 180, in iteration
    avg_loss = total_loss / totol_length
ZeroDivisionError: float division by zero
